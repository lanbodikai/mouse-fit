<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Mouse-Fit — Grip Checker</title>

<link rel="stylesheet" href="/neon.css" />
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@500;700&display=swap" rel="stylesheet" />

<style>
:root{
  --bg:#05060a; --fg:#eaf0ff; --sub:#a6b0c8; --border:rgba(255,255,255,.10);
  --g1:#7c3aed; --g2:#22d3ee; --g3:#a78bfa;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:Lexend, system-ui, Arial;
  color:var(--fg);
}

/* neon page frame */
.page-frame{
  position:fixed; inset:6px; pointer-events:none; z-index:1000;
  border-radius:16px;
  border:1px solid rgba(167,139,250,.35);
  box-shadow:inset 0 0 0 1px rgba(34,211,238,.18), 0 0 18px rgba(124,58,237,.18);
}
/* stage */
.wrap{position:relative;height:100dvh;padding-top:6px}
video,canvas{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
canvas#frame{z-index:1} video{z-index:0}
.gripGuide{position:absolute;left:6vw;right:6vw;top:10vh;bottom:26vh;border:3px dashed rgba(255,255,255,0.65);border-radius:14px;background:rgba(255,255,255,0.06);display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:2}
.label{position:absolute;top:-14px;left:14px;background:#0b1224;border:1px solid #263041;color:#cfe9f6;font-size:12px;font-weight:700;padding:3px 8px;border-radius:999px}

/* badges */
.badge{position:absolute;right:10px;top:10px;background:#0e1424;border:1px solid #263041;color:#9fcde2;font-size:12px;padding:4px 8px;border-radius:999px;z-index:6}
.toast{position:absolute;top:12px;left:50%;transform:translateX(-50%);background:#0e1424;border:1px solid #2a3442;color:#cdd8e4;padding:8px 12px;border-radius:10px;font-size:13px;display:none;z-index:7}
.countdown{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);font-size:22vmin;font-weight:900;color:#fff;text-shadow:0 2px 10px rgba(0,0,0,0.6);pointer-events:none;z-index:8}

/* bottom neon control dock */
.control-dock{
  position:absolute; left:0; right:0; bottom:0; z-index:5;
  padding:14px 12px 16px;
  background:linear-gradient(180deg,rgba(0,0,0,0) 0%, rgba(10,15,25,.55) 30%, rgba(10,15,25,.80) 100%);
}
.panel{
  max-width:1200px; margin:0 auto;
  border:1px solid rgba(167,139,250,.25);
  background:rgba(255,255,255,.05);
  backdrop-filter: blur(8px);
  border-radius:14px;
  box-shadow:inset 0 0 0 1px rgba(34,211,238,.12), 0 0 24px rgba(124,58,237,.16);
  padding:12px;
}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.toolbar{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;margin-top:8px}
.btn-group{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px}
.meta{display:flex;gap:10px;align-items:center;justify-content:flex-end}
.pill{padding:4px 10px;border-radius:999px;background:#0f1524;border:1px solid #2a2f40;font-size:12px;color:#cfe9f6}

button,.btn-link{background:#101626;color:var(--fg);border:1px solid #223049;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;text-decoration:none}
button.primary{background:linear-gradient(90deg,var(--g1),var(--g2),var(--g3));border-color:transparent;box-shadow:0 0 18px rgba(124,58,237,.35),0 0 28px rgba(34,211,238,.22)}
select{background:#0e1220;color:#e8eef7;border:1px solid #2b3241;border-radius:10px;padding:8px}
.hint{font-size:14px;color:var(--sub);margin:6px 0 2px}
.thumbs{display:flex;gap:10px;margin-top:6px;align-items:center}
.thumbs img{width:72px;height:48px;object-fit:cover;border-radius:8px;border:1px solid #2a2f40;background:#0b0b0f}
@media (max-width:720px){ .btn-group{grid-template-columns:repeat(auto-fit,minmax(140px,1fr))} }
</style>
<script src="/js/nav.js" defer></script>
</head>
<body>

<div class="page-frame" aria-hidden="true"></div>


<div class="wrap">
  <video id="cam" playsinline autoplay muted></video>
  <canvas id="frame"></canvas>

  <div class="gripGuide"><span class="label" id="guideLabel">Step 1/3 — TOP view</span></div>

  <div id="status" class="badge">Live</div>
  <div id="toast" class="toast"></div>
  <div id="countdown" class="countdown">5</div>

  <!-- Bottom neon control dock -->
  <div class="control-dock">
    <div class="panel">
      <div class="row" style="gap:12px; margin-bottom:6px;">
        <label>Camera:</label>
        <select id="cameraSelect"></select>
        <button id="refreshCams">Refresh</button>
        <span id="camName" class="pill">—</span>
      </div>

      <div id="hint" class="hint">
        Capture 3 angles: <b>Top</b>, <b>Right</b>, <b>Left</b>. Hold your own mouse in your natural grip inside the dashed box.
      </div>

      <div class="thumbs">
        <img id="thumbTop"   alt="Top"   title="Top">
        <img id="thumbRight" alt="Right" title="Right">
        <img id="thumbLeft"  alt="Left"  title="Left">
      </div>

      <!-- LIVE -->
      <div class="toolbar" id="liveBtns">
        <div class="btn-group">
          <button id="timer" class="primary">Capture in 5 Seconds (Space)</button>
          <button id="snap">Capture now</button>
          <button id="toggleSkel">Turn off skeleton</button>
          <button id="retakeAll">Retake all (clear)</button>
        </div>
        <div class="meta">
          <span id="skelState" class="pill">Skeleton: On</span>
          <span id="stepPill" class="pill">Step: live</span>
          <span id="viewPill" class="pill">View: Top</span>
        </div>
      </div>

      <!-- FROZEN -->
      <div class="toolbar" id="frozenBtns" style="display:none;">
        <div class="btn-group">
          <button id="accept">Use This Angle</button>
          <button id="retake">Retake</button>
          <button id="classify" disabled>Classify Grip</button>
          <a id="gotoReport" class="btn-link" href="./report.html">Go to Report</a>
        </div>
        <div class="meta">
          <span id="resultPill" class="pill">Result: —</span>
        </div>
      </div>
    </div>
  </div>
</div>

<button id="startCamBtn" style="position:fixed; inset:auto 12px 12px auto; z-index:9999; background:linear-gradient(90deg,var(--g1),var(--g2),var(--g3)); color:#fff; border:0; padding:10px 14px; border-radius:12px; display:none;">Tap to start camera</button>

<script type="module" src="../js/grip.js"></script>
<script type="module">
  window.finishGrip = (grip /* "palm"|"claw"|"fingertip" */) => {
    sessionStorage.setItem("mf:grip", grip);
    location.href = "/htmls/report.html";
  };
</script>

</body>
</html>
